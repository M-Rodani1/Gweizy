#!/bin/sh

# Run tests before commit
cd frontend

echo "Running tests..."
# Run tests and capture output
TEST_OUTPUT=$(npm test -- --run 2>&1)
echo "$TEST_OUTPUT" | tail -20

# Check if tests passed (look for "passed" and no "failed")
if echo "$TEST_OUTPUT" | grep -q "Tests.*[0-9]\+ passed" && ! echo "$TEST_OUTPUT" | grep -q "Tests.*[0-9]\+ failed"; then
  echo "All tests passed!"
  exit 0
else
  echo "Tests failed. Please fix errors before committing."
  exit 1
fi
